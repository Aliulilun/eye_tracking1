# 視線估計系統配置文件
# Gaze Estimation System Configuration

# ==================== 人臉檢測配置 ====================
face_detection:
  # MediaPipe Face Mesh 配置
  min_confidence: 0.5          # 最小檢測置信度
  max_num_faces: 1             # 最大檢測人臉數量
  model_selection: 1           # 0: 近距離模型 (2m內), 1: 全距離模型 (5m內)
  refine_landmarks: true       # 是否精細化眼睛和嘴唇的特徵點
  
  # 用於頭部姿態估計的關鍵特徵點索引 (從 MediaPipe 468 個點中選擇)
  # 對應: 左眼外角, 左眼內角, 右眼內角, 右眼外角, 鼻尖, 鼻底, 左嘴角, 右嘴角
  key_landmarks_indices: [33, 133, 362, 263, 1, 2, 61, 291]

# ==================== 頭部姿態估計配置 ====================
head_pose:
  face_model_path: "models/face_model_mediapipe.txt"  # 3D 人臉模型文件
  use_iterative: true          # 是否使用迭代優化 solvePnP
  method: "SOLVEPNP_ITERATIVE" # solvePnP 方法: ITERATIVE, EPNP, P3P

# ==================== 圖像正規化配置 ====================
normalization:
  focal_length: 960            # 虛擬相機焦距 (像素)
  distance: 600                # 標準化距離 (mm)
  output_size: [224, 224]      # 輸出圖像尺寸 (寬, 高)

# ==================== 神經網絡模型配置 ====================
model:
  checkpoint_path: "models/epoch_24_ckpt.pth.tar"  # 預訓練模型路徑
  device: "cpu"                # 計算設備: "cuda" 或 "cpu"
  input_size: [224, 224]       # 模型輸入尺寸
  
  # ImageNet 標準化參數
  normalize_mean: [0.485, 0.456, 0.406]
  normalize_std: [0.229, 0.224, 0.225]

# ==================== 相機配置 ====================
camera:
  # 如果沒有相機校正文件，使用以下默認參數
  use_default_intrinsics: true
  default_focal_length_factor: 1.0  # 焦距 = 圖像寬度 * 此係數
  
  # 可選：相機校正文件路徑 (.xml 格式)
  calibration_file: null

# ==================== 輸出配置 ====================
output:
  save_visualization: true     # 是否保存可視化結果
  save_dir: "output/results"   # 輸出目錄
  show_plot: true              # 是否顯示結果圖像
  save_intermediate: false     # 是否保存中間階段結果
  
  # 繪圖配置
  visualization:
    gaze_arrow_length: 100     # 視線箭頭長度 (像素)
    gaze_arrow_color: [0, 0, 255]  # 視線箭頭顏色 (BGR)
    gaze_arrow_thickness: 3    # 箭頭粗細
    landmark_color: [0, 255, 0]     # 特徵點顏色 (BGR)
    landmark_radius: 2         # 特徵點半徑

# ==================== 調試配置 ====================
debug:
  verbose: true                # 是否打印詳細信息
  print_timings: true          # 是否打印各階段耗時
  save_debug_images: false     # 是否保存調試圖像

